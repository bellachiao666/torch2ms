--- pytorch+++ mindspore@@ -1,35 +1,39 @@+import mindspore as ms
+import mindspore.nn as msnn
+import mindspore.ops as msops
+import mindspore.mint as mint
+from mindspore.mint import nn, ops
 from efficient_kan import KAN
 
 # Train on MNIST
-import torch
-import torch.nn as nn
-import torch.optim as optim
-import torchvision
-import torchvision.transforms as transforms
-from torch.utils.data import DataLoader
+# import torch
+# import torch.nn as nn
+# import torch.optim as optim
+# import torchvision
+# import torchvision.transforms as transforms
+# from torch.utils.data import DataLoader
 from tqdm import tqdm
 
 # Load MNIST
-transform = transforms.Compose(
-    [transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))]
-)
+transform = ms.dataset.transforms.Compose(
+    [transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))])  # 'torchvision.transforms.ToTensor' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;; 'torchvision.transforms.Normalize' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 trainset = torchvision.datasets.MNIST(
     root="./data", train=True, download=True, transform=transform
-)
+)  # 'torchvision.datasets.MNIST' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 valset = torchvision.datasets.MNIST(
     root="./data", train=False, download=True, transform=transform
-)
-trainloader = DataLoader(trainset, batch_size=64, shuffle=True)
-valloader = DataLoader(valset, batch_size=64, shuffle=False)
+)  # 'torchvision.datasets.MNIST' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
+trainloader = DataLoader(trainset, batch_size=64, shuffle=True)  # 'torch.utils.data.DataLoader' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
+valloader = DataLoader(valset, batch_size=64, shuffle=False)  # 'torch.utils.data.DataLoader' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 
 # Define model
 model = KAN([28 * 28, 64, 10])
-device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
+device = torch.device("cuda" if torch.cuda.is_available() else "cpu")  # 'torch.cuda.is_available' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;; 'torch.device' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 model.to(device)
 # Define optimizer
-optimizer = optim.AdamW(model.parameters(), lr=1e-3, weight_decay=1e-4)
+optimizer = mint.optim.AdamW(model.parameters(), lr=1e-3, weight_decay=1e-4)
 # Define learning rate scheduler
-scheduler = optim.lr_scheduler.ExponentialLR(optimizer, gamma=0.8)
+scheduler = optim.lr_scheduler.ExponentialLR(optimizer, gamma=0.8)  # 'torch.optim.lr_scheduler.ExponentialLR' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 
 # Define loss
 criterion = nn.CrossEntropyLoss()
@@ -51,6 +55,7 @@     model.eval()
     val_loss = 0
     val_accuracy = 0
+    # 'torch.no_grad' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
     with torch.no_grad():
         for images, labels in valloader:
             images = images.view(-1, 28 * 28).to(device)
