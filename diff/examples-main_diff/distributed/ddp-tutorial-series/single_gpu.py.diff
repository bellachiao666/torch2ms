--- pytorch+++ mindspore@@ -1,13 +1,20 @@-import torch
-import torch.nn.functional as F
-from torch.utils.data import Dataset, DataLoader
+import mindspore as ms
+import mindspore.nn as msnn
+import mindspore.ops as msops
+import mindspore.mint as mint
+from mindspore.mint import nn, ops
+# import torch
+# import torch.nn.functional as F
+# from torch.utils.data import Dataset, DataLoader
 from datautils import MyTrainDataset
 
 
 class Trainer:
+    # 'torch.utils.data.DataLoader' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
+    # 'torch.optim.Optimizer' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
     def __init__(
         self,
-        model: torch.nn.Module,
+        model: msnn.Cell,
         train_data: DataLoader,
         optimizer: torch.optim.Optimizer,
         gpu_id: int,
@@ -22,7 +29,7 @@     def _run_batch(self, source, targets):
         self.optimizer.zero_grad()
         output = self.model(source)
-        loss = F.cross_entropy(output, targets)
+        loss = F.cross_entropy(output, targets)  # 'torch.nn.functional.cross_entropy' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
         loss.backward()
         self.optimizer.step()
 
@@ -37,7 +44,7 @@     def _save_checkpoint(self, epoch):
         ckp = self.model.state_dict()
         PATH = "checkpoint.pt"
-        torch.save(ckp, PATH)
+        torch.save(ckp, PATH)  # 'torch.save' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
         print(f"Epoch {epoch} | Training checkpoint saved at {PATH}")
 
     def train(self, max_epochs: int):
@@ -49,18 +56,19 @@ 
 def load_train_objs():
     train_set = MyTrainDataset(2048)  # load your dataset
-    model = torch.nn.Linear(20, 1)  # load your model
-    optimizer = torch.optim.SGD(model.parameters(), lr=1e-3)
+    model = nn.Linear(20, 1)  # load your model
+    optimizer = torch.optim.SGD(model.parameters(), lr=1e-3)  # 'torch.optim.SGD' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
     return train_set, model, optimizer
 
 
+# 'torch.utils.data.Dataset' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 def prepare_dataloader(dataset: Dataset, batch_size: int):
     return DataLoader(
         dataset,
         batch_size=batch_size,
         pin_memory=True,
         shuffle=True
-    )
+    )  # 'torch.utils.data.DataLoader' 未在映射表(api_mapping_out_excel.json)中找到，需手动确认;
 
 
 def main(device, total_epochs, save_every, batch_size):
