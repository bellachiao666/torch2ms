--- pytorch+++ mindspore@@ -1,3 +1,8 @@+import mindspore as ms
+import mindspore.nn as msnn
+import mindspore.ops as msops
+import mindspore.mint as mint
+from mindspore.mint import nn, ops
 """ Hybrid Vision Transformer (ViT) in PyTorch
 
 A PyTorch implement of the Hybrid Vision Transformers as described in:
@@ -16,8 +21,8 @@ from functools import partial
 from typing import Dict, Tuple, Type, Union
 
-import torch
-import torch.nn as nn
+# import torch
+# import torch.nn as nn
 
 from timm.data import IMAGENET_DEFAULT_MEAN, IMAGENET_DEFAULT_STD
 from timm.layers import StdConv2dSame, StdConv2d, ConvNormAct, to_ntuple, HybridEmbed
@@ -29,7 +34,7 @@ from .vision_transformer import VisionTransformer
 
 
-class ConvStem(nn.Sequential):
+class ConvStem(msnn.SequentialCell):
     def __init__(
             self,
             in_chans: int = 3,
@@ -128,7 +133,7 @@             bias_k = k.replace('classifier.proj', 'head.bias')
             k = k.replace('classifier.proj', 'head.weight')
             v = v.T
-            out[bias_k] = torch.zeros(v.shape[0])
+            out[bias_k] = mint.zeros(v.shape[0])
         out[k] = v
     return out
 
